(function(t){function e(e){for(var a,i,s=e[0],l=e[1],c=e[2],d=0,f=[];d<s.length;d++)i=s[d],o[i]&&f.push(o[i][0]),o[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(f.length)f.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},o={app:0},r=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"32bc":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],i=(n("5c0b"),n("2877")),s={},l=Object(i["a"])(s,o,r,!1,null,null,null),c=l.exports,u=n("8c4f"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pages-view"},[n("header-bar"),n("router-view")],1)},f=[],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header-bar"},[n("van-nav-bar",{attrs:{title:"创新院比赛评分系统"},on:{"click-right":t.onClickRight}},[n("van-icon",{attrs:{slot:"right",name:"wap-home"},slot:"right"})],1)],1)},h=[],v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-cell-group",[n("van-field",{attrs:{clearable:"",label:"创新",placeholder:"请输入评分",required:"","right-icon":"question-o"},on:{"click-right-icon":function(e){return t.$toast(t.question)}},model:{value:t.innovateScore,callback:function(e){t.innovateScore=e},expression:"innovateScore"}}),n("van-field",{attrs:{clearable:"",label:"实用",placeholder:"请输入评分",required:"","right-icon":"question-o"},on:{"click-right-icon":function(e){return t.$toast(t.question)}},model:{value:t.functionalScore,callback:function(e){t.functionalScore=e},expression:"functionalScore"}})],1),n("van-button",{attrs:{size:"large"},on:{click:t.submit}},[t._v("提交成绩")])],1)},m=[],g=n("f499"),b=n.n(g),w=n("e814"),$=n.n(w),_={name:"JudgeView",data:function(){return{id:null,score:null,question:"百分制",innovateScore:null,functionalScore:null,title:"评分"}},created:function(){var t=this;t.id=this.$route.params.id},methods:{alert:function(t){var e=this;e.$dialog.alert({title:"提交失败",message:t})},submit:function(){var t=this;t.innovateScore&&t.functionalScore?(t.score=$()(t.innovateScore)+$()(t.functionalScore),t.$http.post("/api/grade/",{composition:t.id,score:t.score}).then(function(e){t.$toast("提交成功，请继续为其他团队评分"),t.$router.go(-1)}).catch(function(e){var n=e;if(e.response){if(400===e.response.status)return n=b()(e.response.data),void t.alert(n);t.alert(n)}else e.request,t.alert(n)})):t.alert("请填写全部的分项")}}},y=_,k=Object(i["a"])(y,v,m,!1,null,"6deff65e",null),x=k.exports,S={name:"header-bar",components:{JudgeView:x},data:function(){return{}},methods:{onClickRight:function(){this.$router.push("/")}}},j=S,O=(n("ae2f"),Object(i["a"])(j,p,h,!1,null,"220d7f59",null)),q=O.exports,C={name:"pages-view",components:{HeaderBar:q},data:function(){return{}},methods:{}},E=C,L=Object(i["a"])(E,d,f,!1,null,"e8ab1372",null),z=L.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,function(t){return n("van-cell",{key:t.id,attrs:{title:t.name,to:{name:"CompositionList",params:{id:t.id}}}})}),1)},J=[],M={name:"CompetitionList",data:function(){return{finished:!0,loading:!1,list:[]}},methods:{alert:function(t){var e=this;e.$dialog.alert({title:"获取比赛信息失败",message:t})}},mounted:function(){var t=this;this.$http.get("/api/competition/").then(function(e){t.list=e.data,console.log(e)}).catch(function(e){var n=e;e.response?t.alert(n):(e.request,t.alert(n))})}},R=M,T=Object(i["a"])(R,P,J,!1,null,"d8f07818",null),V=T.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,function(e){return n("van-cell",{key:e.id,attrs:{title:t.title(e)},on:{click:function(n){return t.to(e)}}})}),1)},A=[],H=(n("7f7f"),{name:"CompositionList",data:function(){return{id:null,finished:!0,loading:!1,list:[]}},created:function(){var t=this;t.id=this.$route.params.id},methods:{title:function(t){return t.score?t.name+" "+t.score:t.name},to:function(t){var e=this;t.score?e.$dialog.alert({title:"警告",message:"评分不可修改！"}):e.$router.push("/judge/"+t.id)},alert:function(t){var e=this;e.$dialog.alert({title:"获取团队信息失败",message:t})}},mounted:function(){var t=this;t.$http.get("/api/composition/?competition="+t.id).then(function(e){t.list=e.data}).catch(function(e){var n=e;e.response?t.alert(n):(e.request,t.alert(n))})}}),I=H,U=Object(i["a"])(I,B,A,!1,null,"f39cb61a",null),D=U.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{height:"100vh"}},[n("div"),n("div",{staticStyle:{position:"absolute",bottom:"50%",width:"100%"}},[n("van-panel",{attrs:{desc:"描述信息",status:"状态",title:"标题"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("h2",[t._v("请登录")])]),n("van-field",{attrs:{label:"密码",placeholder:"请输入登陆码",required:"",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("van-button",{attrs:{size:"large"},on:{click:t.loginCxy}},[t._v("登陆")])],1)],1)],1)])},G=[],K={name:"LoginView",data:function(){return{password:""}},methods:{alert:function(t){var e=this;e.$dialog.alert({title:"登陆失败",message:t})},loginCxy:function(){var t=this,e=this;e.$http.post("/api/token/",{code:e.password}).then(function(e){localStorage["token"]="Bearer "+e.data["access"],t.$http.defaults.headers.common["Authorization"]="Bearer "+e.data["access"],t.$router.push("/")}).catch(function(t){var n=t.message;t.response?("401"===t.response.status&&(n="密码错误"),e.alert(n)):(t.request,e.alert(n))})}}},N=K,Q=Object(i["a"])(N,F,G,!1,null,"194baba4",null),W=Q.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-cell",{attrs:{title:"赛事简介",value:"内容",size:"large",label:"描述信息"}}),n("van-cell",{attrs:{title:"评分细则",value:"内容",size:"large",label:"描述信息"}})],1)},Y=[],Z={name:"Rules"},tt=Z,et=Object(i["a"])(tt,X,Y,!1,null,"89c78798",null),nt=et.exports;a["a"].use(u["a"]);var at=new u["a"]({mode:"history",base:"/",routes:[{path:"/",redirect:"/competition/",component:z,children:[{path:"competition",name:"CompetitionList",component:V},{path:"composition/:id",name:"CompositionList",component:D},{path:"judge/:id",name:"JudgeView",component:x},{path:"rules",name:"rules",component:nt}]},{path:"/login",component:W}]});at.beforeEach(function(t,e,n){if("/login"!==t.path&&!localStorage.token)return n("/login");n()});var ot=at,rt=n("2f62");a["a"].use(rt["a"]);var it=new rt["a"].Store({state:{},mutations:{},actions:{}}),st=n("b970"),lt=(n("157a"),n("795b")),ct=n.n(lt),ut=n("bc3a"),dt=n.n(ut);dt.a.defaults.baseURL="http://127.0.0.1:8000",dt.a.defaults.headers.post["Content-Type"]="application/json",dt.a.interceptors.request.use(function(t){var e=localStorage.getItem("token");return e&&(t.headers.common["Authorization"]=e),t},function(t){return ct.a.reject(t)}),dt.a.interceptors.response.use(function(t){return t},function(t){var e=t.response;if(e)switch(e.status){case 401:case 403:ot.push("/login/"),t.message="登录失效，请重新登录";break}else t.message="网络连接失败，请检查网络";return ct.a.reject(t)});var ft=dt.a;a["a"].config.productionTip=!1,a["a"].use(st["a"]),a["a"].prototype.$http=ft,new a["a"]({router:ot,store:it,render:function(t){return t(c)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var a=n("5e27"),o=n.n(a);o.a},"5e27":function(t,e,n){},ae2f:function(t,e,n){"use strict";var a=n("32bc"),o=n.n(a);o.a}});
//# sourceMappingURL=app.5e202af9.js.map